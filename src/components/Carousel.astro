---
export interface CarouselItem {
  imageSrc: string;
  alt?: string;
  caption?: string;
  content?: string;
}

export interface Props {
  id?: string;
  items: CarouselItem[];
  className?: string;
}

const {
  id = "carousel",
  items = [],
  className = "",
} = Astro.props;
---

<section class={`w-full py-8 bg-gray-50 dark:bg-gray-900 ${className}`}>
  <div id={id} class="relative max-w-3xl mx-auto" data-carousel="slide">
    <!-- Slides -->
    <div class="relative h-72 overflow-hidden rounded-xl shadow-lg">
      {items.map((item, idx) => (
        <div
          class={`duration-700 ease-in-out transition-opacity ${idx === 0 ? 'block' : 'hidden'}`}
          data-carousel-item={idx === 0 ? "active" : ""}
        >
          <img
            src={item.imageSrc}
            alt={item.alt || ''}
            class="w-full h-72 object-cover bg-gray-200 dark:bg-gray-700"
            loading="lazy"
          />
          {(item.caption || item.content) && (
            <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/70 to-transparent p-4">
              {item.caption && <div class="text-white text-lg font-semibold">{item.caption}</div>}
              {item.content && <div class="text-white text-sm mt-1" set:html={item.content}></div>}
            </div>
          )}
        </div>
      ))}
    </div>
    {/* Slider controls */}
    <button type="button" class="absolute top-1/2 left-2 z-30 flex items-center justify-center h-10 w-10 bg-white dark:bg-gray-800 rounded-full shadow -translate-y-1/2 hover:bg-primary-100 dark:hover:bg-primary-800 transition" data-carousel-prev aria-label="Previous">
      <svg class="w-6 h-6 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/></svg>
    </button>
    <button type="button" class="absolute top-1/2 right-2 z-30 flex items-center justify-center h-10 w-10 bg-white dark:bg-gray-800 rounded-full shadow -translate-y-1/2 hover:bg-primary-100 dark:hover:bg-primary-800 transition" data-carousel-next aria-label="Next">
      <svg class="w-6 h-6 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg>
    </button>
    {/* Dots */}
    <div class="flex justify-center mt-4 gap-2">
      {items.map((_, idx) => (
        <button
          type="button"
          class="w-3 h-3 rounded-full transition border-2"
          aria-label={`Go to slide ${idx + 1}`}
          data-carousel-slide-to={idx}
        ></button>
      ))}
    </div>
  </div>
</section>
